import random
import Points
import matplotlib.pyplot as plt
from operator import gt, lt, ge, le

#points = Points.circle(200)
#points = [(1.5, 12.5), (1.7, 4.5), (3.6, 11.7), (5.0, 7.4), (7.0, 13.4), (7.1, 3.4), (9.4, 4.5), (10.1, 13.4), (10.1, 8.8), (11.5, 15.6), (11.6, 12.3), (11.6, 6.4), (11.9, 10.2), (12.3, 10.1), (14.3, 13.8), (15.1, 2.8), (17.8, 10.7), (18.1, 12.1), (18.5, 12.3), (19.7, 10.6)]
#points = [(1.3, 14.3), (2.7, 3.5), (3.1, 7.6), (5.0, 11.0), (5.3, 8.8), (5.6, 11.9), (7.1, 10.0), (7.9, 1.6), (8.6, 12.2), (8.7, 9.7), (9.0, 4.5), (9.4, 16.1), (12.2, 10.6), (13.3, 0.8), (13.7, 18.0), (14.6, 7.5), (15.5, 11.3), (16.6, 16.8), (18.2, 10.3), (18.6, 5.8)]
#points = [(1.9, 9.2), (2.2, 14.0), (2.4, 11.6), (2.9, 6.5), (3.3, 16.0), (3.7, 3.7), (4.6, 11.0), (5.7, 4.3), (6.0, 12.1), (7.0, 7.5), (7.1, 12.0), (9.5, 13.3), (10.9, 12.6), (11.3, 5.3), (11.6, 1.3), (11.9, 14.3), (13.5, 10.6), (13.8, 19.1), (13.8, 0.9), (14.7, 15.3)]
points = [(3.7, 91.5), (4.7, 90.6), (5.9, 119.0), (10.6, 135.5), (12.2, 64.2), (14.5, 107.7), (14.7, 86.9), (15.5, 82.0), (15.5, 86.4), (18.1, 145.9), (24.1, 140.0), (28.1, 133.7), (28.2, 120.0), (29.9, 145.5), (30.7, 53.9), (31.9, 167.3), (31.9, 119.1), (32.5, 129.3), (33.8, 65.9), (34.4, 49.2), (35.4, 25.6), (35.7, 34.3), (36.0, 109.8), (36.8, 113.9), (37.1, 74.1), (37.7, 85.7), (38.0, 109.0), (38.6, 58.8), (39.3, 108.5), (40.7, 93.7), (44.4, 25.4), (44.5, 26.2), (45.3, 78.2), (47.3, 29.7), (47.7, 141.7), (48.8, 28.4), (51.6, 174.8), (51.6, 56.1), (52.9, 32.0), (52.9, 42.9), (54.0, 126.9), (54.5, 49.6), (55.8, 17.8), (56.3, 20.9), (57.1, 67.8), (57.2, 34.9), (57.3, 151.8), (57.5, 119.6), (57.5, 20.7), (58.4, 24.4), (59.1, 71.2), (59.9, 56.7), (61.5, 18.5), (62.7, 65.5), (63.0, 147.1), (63.5, 133.7), (64.8, 188.5), (66.9, 69.2), (67.5, 177.2), (67.8, 134.4), (68.0, 44.4), (69.5, 131.6), (70.7, 108.5), (70.8, 147.7), (72.3, 178.7), (73.1, 185.6), (73.4, 85.7), (73.4, 31.1), (73.5, 134.0), (77.2, 47.0), (77.7, 181.6), (78.1, 132.0), (79.5, 41.9), (79.8, 41.7), (80.2, 101.6), (81.4, 48.8), (81.7, 52.1), (82.2, 103.5), (83.7, 63.5), (84.0, 103.3), (84.3, 92.3), (84.9, 35.1), (85.0, 21.2), (85.1, 21.8), (85.7, 11.0), (86.3, 69.9), (88.5, 64.8), (89.1, 129.0), (90.0, 158.4), (91.1, 137.8), (92.1, 140.9), (93.0, 151.7), (93.9, 111.8), (93.9, 89.4), (94.6, 44.7), (95.2, 15.2), (96.0, 136.8), (96.0, 119.4), (96.4, 76.1), (96.6, 196.5), (99.4, 8.6), (99.7, 136.5), (101.6, 187.7), (103.6, 166.7), (104.8, 185.1), (107.1, 190.8), (107.1, 137.3), (108.1, 19.8), (108.9, 13.7), (110.4, 60.4), (111.1, 121.6), (112.3, 155.1), (112.3, 112.8), (113.2, 126.1), (113.4, 66.1), (113.4, 77.9), (113.6, 47.0), (114.7, 82.0), (115.8, 3.9), (116.5, 37.5), (116.7, 74.5), (119.0, 20.5), (122.3, 55.2), (122.4, 100.4), (123.0, 82.4), (124.1, 26.8), (124.1, 125.9), (124.6, 90.3), (125.0, 49.4), (125.7, 69.3), (126.0, 108.3), (128.1, 75.4), (128.3, 48.6), (128.3, 37.2), (128.5, 56.6), (130.3, 104.6), (130.3, 18.7), (130.5, 106.9), (131.9, 84.8), (132.3, 182.9), (132.3, 122.4), (132.7, 88.6), (132.7, 177.9), (132.7, 65.5), (133.8, 86.9), (134.1, 176.5), (135.3, 165.3), (136.0, 179.7), (136.8, 184.1), (137.4, 31.4), (137.8, 33.4), (137.9, 188.7), (138.0, 100.2), (138.7, 168.2), (139.1, 89.2), (145.4, 32.6), (147.3, 142.1), (147.3, 41.4), (147.4, 170.5), (147.5, 125.4), (148.2, 85.3), (148.8, 178.1), (149.4, 41.6), (149.9, 93.9), (150.1, 14.4), (151.0, 70.6), (151.5, 168.1), (159.2, 43.8), (160.5, 131.4), (161.7, 158.7), (163.2, 67.2), (163.4, 56.0), (165.7, 74.2), (166.3, 90.2), (168.0, 37.8), (168.9, 138.3), (169.5, 76.1), (169.9, 164.0), (171.4, 80.1), (171.7, 109.4), (172.3, 117.5), (174.2, 143.7), (174.2, 123.4), (174.4, 119.2), (174.8, 51.1), (175.1, 165.2), (177.9, 154.2), (178.0, 42.1), (181.2, 142.2), (181.5, 66.9), (183.3, 52.5), (184.5, 129.4), (186.0, 97.1), (191.0, 75.5), (191.4, 75.0), (191.5, 66.7), (191.6, 119.4), (191.7, 120.5), (192.7, 105.4), (196.7, 104.7)]

def hall(sign):
    hallpoints = []
    hallpoints.append(points[0])
    hallpoints.append(points[1])
    for i in range(2,len(points)):
        while len(hallpoints) >= 2 and sign(orientation(hallpoints[-2], hallpoints[-1], points[i]), 0):
            print("popping:", hallpoints[-1])
            hallpoints.pop(-1)
        hallpoints.append(points[i])
    return hallpoints

def orientation(p1,p2,p3):
    return (p1[0] * (p2[1]-p3[1]) + p2[0]*(p3[1]-p1[1]) + p3[0]*(p1[1]-p2[1]))


def hall2(h):
    CHpoints.append(points[0])
    CHpoints.append(points[1])
    for i in range(2,len(points)):
        while len(CHpoints) >= 2 and orientation2(CHpoints[-2], CHpoints[-1], points[i]) in h:
            print("popping:", CHpoints[-1])
            CHpoints.pop(-1)
        CHpoints.append(points[i])


def orientation2(p1, p2, p3):
    val = (float(p2[1] - p1[1]) * (p3[0] - p2[0])) - (float(p2[0] - p1[0]) * (p3[1] - p2[1]))
    if (val > 0):
        # right turn
        return 1
    elif (val < 0):
        # left turn
        return 2
    else:
        # straight
        return 0
    

CHpoints = []
points.sort(key=lambda x:x[0])
upper = le; lower = ge
upperHall = hall(upper)
lowerHall = hall(lower)
lowerHall.pop(-1); lowerHall.pop(0); lowerHall.reverse()
CHpoints.extend(upperHall); CHpoints.extend(lowerHall)

#hall2(h=[2,0])
#hall2(h=[1,0])

print("points", points)
print("CHpoints", CHpoints)



x = [a[0] for a in points]
y = [b[1] for b in points]
plt.scatter(x, y)
x1 = [a[0] for a in CHpoints]
y1 = [b[1] for b in CHpoints]
plt.plot(x1,y1)
plt.show()
